# Set X
X <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- model$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X %*% Pz %*% t(X)
# Set X
X <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- model$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X)
View(X)
# Set X
X <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X1)
View(X1)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz
# Set X
X1 <- prmatrix(model.matrix(~educ, data = card))
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- prmatrix(m$coefficients)
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz
# Set X
X1 <- prmatrix(model.matrix(~educ, data = card))
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- prmatrix(m$coefficients)
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz %*% X1
# Set X
X1 <- prmatrix(model.matrix(~educ, data = card))
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- prmatrix(m$coefficients)
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X1) %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, nearc4, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X1) %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
t(X1) %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz -> %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz %>% %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz %*% X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 * Pz * X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz * X1
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
X1 %*% Pz
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V %>%
X1 %*% Pz
setwd("D:/GitHub/ECMA-31100/PS 1")
library(haven)
library(dplyr)
jtrain <- read_dta('jtrain98.dta')
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V %>%
X1 %*% Pz
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz
V<- V%*% X1
View(Pz)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz
V<- V%*% t(X1)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz %*% t(X1)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz %*% t(X1)
nrow(V)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#sigma^2
sum(resid(m)^2)/N
#V_hat
V<-X1 %*% Pz %*% t(X1)
nrow(V)
ncol(V)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#n* sigma^2
nsignma <- sum(resid(m)^2)
#V_hat
V<-nsigma * Inv(t(X1) %*% Pz %*% X1)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#n* sigma^2
nsigma <- sum(resid(m)^2)
#V_hat
V<-nsigma * Inv(t(X1) %*% Pz %*% X1)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#n* sigma^2
nsigma <- sum(resid(m)^2)
#V_hat
V<-nsigma * inv(t(X1) %*% Pz %*% X1)
setwd("D:/GitHub/ECMA-31100/PS 1")
library(haven)
library(dplyr)
library(matlib)
# Set X
X1 <- model.matrix(~educ, data = card)
#find Pz
m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
Pz <- m$coefficients
#n* sigma^2
nsigma <- sum(resid(m)^2)
#V_hat
V<-nsigma * solve(t(X1) %*% Pz %*% X1)
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
diag(3)^(-1)
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
magic(3)^(-1)
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
matrix(1,3,3)^(-1)
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
matrix(1,3,3) %^% -1
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
matrix(1,3,3).^ -1
# # Set X
# X1 <- model.matrix(~educ, data = card)
# #find Pz
# m <- lm(formula = cbind(1, educ) ~ nearc4, data = card)
# Pz <- m$coefficients
#
#
# #n* sigma^2
# nsigma <- sum(resid(m)^2)
#
# #V_hat
# V<-nsigma * solve(t(X1) %*% Pz %*% X1)
matrix(1,3,3)^ -1
#Initialization:
card <- read_dta('card.dta')
#Y <- log(card$wage)
N <- nrow(card)
#Initialization:
library(gmm)
#Initialization:
install.packages("gmm")
library(gmm)
card <- read_dta('card.dta')
#Y <- log(card$wage)
N <- nrow(card)
#2SLS:
model10 <- tsls(log(wage) ~ educ, ~ nearc4)
#2SLS:
model10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(model10)
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(m10)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(m10)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
summary(m11)
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(m10)
m10$vcov
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
summary(m11)
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(m10)
m10$vcov
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
summary(m11)
m11$vcov
#2SLS:
m20 <- tsls(log(wage) ~ educ + south + smsa, ~ nearc4+ south + smsa, data = card)
summary(m20)
m20$vcov
#GMM:
m21 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
summary(m21)
m21$vcov
#2SLS:
m20 <- tsls(log(wage) ~ educ + south + smsa, ~ nearc4+ south + smsa, data = card)
summary(m20)
m20$vcov
#GMM:
m21 <- gmm(log(wage) ~ educ + south + smsa, ~ nearc4+ south + smsa, data = card)
summary(m21)
m21$vcov
#2SLS:
m20 <- tsls(log(wage) ~ educ + south + smsa, ~ nearc4 + nearc2+ south + smsa, data = card)
summary(m20)
m20$vcov
#GMM:
m21 <- gmm(log(wage) ~ educ + south + smsa, ~ nearc4 + nearc2 + south + smsa, data = card)
summary(m21)
m21$vcov
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
#summary(m10)
#m10$vcov
m10$coefficients['educ']
confint(m10, 'educ', level=0.95)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
# summary(m11)
# m11$vcov
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
summary(m10)
#m10$vcov
m10$coefficients['educ']
confint(m10, 'educ', level=0.95)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
# summary(m11)
# m11$vcov
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
#summary(m10)
#m10$vcov
m10$coefficients['educ']
confint(m10, 'educ', level=0.95)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
# summary(m11)
# m11$vcov
#2SLS:
m10 <- tsls(log(wage) ~ educ, ~ nearc4, data = card)
#summary(m10)
#m10$vcov
m10$coefficients['educ']
confint(m10, 'educ', level=0.95)
#GMM:
m11 <- gmm(log(wage) ~ educ, ~ nearc4, data = card)
# summary(m11)
# m11$vcov
m11$coefficients['educ']
confint(m11, 'educ', level=0.95)
#2SLS:
m20 <- tsls(log(wage) ~ educ + south + smsa, ~ nearc4+ south + smsa, data = card)
# summary(m20)
# m20$vcov
m20$coefficients['educ']
confint(m20, 'educ', level=0.95)
#GMM:
m21 <- gmm(log(wage) ~ educ + south + smsa, ~ nearc4+ south + smsa, data = card)
# summary(m21)
# m21$vcov
m21$coefficients['educ']
confint(m21, 'educ', level=0.95)
#2SLS:
m30 <- tsls(log(wage) ~ educ + south + smsa, ~ nearc4 + nearc2+ south + smsa, data = card)
# summary(m30)
# m30$vcov
m30$coefficients['educ']
confint(m30, 'educ', level=0.95)
#GMM:
m31 <- gmm(log(wage) ~ educ + south + smsa, ~ nearc4 + nearc2 + south + smsa, data = card)
# summary(m31)
# m31$vcov
m31$coefficients['educ']
confint(m31, 'educ', level=0.95)
View(card)
#2SLS:
m40 <- tsls(log(wage) ~ educ + south + smsa + libcrd14 + IQ + KWW + exper + expersq, ~ nearc4 + nearc2 + south + smsa + libcrd14 + IQ + KWW + exper + expersq, data = card)
# summary(m40)
# m40$vcov
m40$coefficients['educ']
confint(m40, 'educ', level=0.95)
#GMM:
m41 <- gmm(log(wage) ~ educ + south + smsa + libcrd14 + IQ + KWW + exper + expersq, ~ nearc4 + nearc2 + south + smsa + libcrd14 + IQ + KWW + exper + expersq, data = card)
# summary(m41)
# m41$vcov
m41$coefficients['educ']
confint(m41, 'educ', level=0.95)
